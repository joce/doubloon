[tox]
envlist = py{310,311,312,313,314}
isolated_build = true
skip_missing_interpreters = true
requires = tox-uv >= 1.29

[gh-actions]
python =
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313
    3.14: py314

[testenv]
description = Run tests and checks for Python {envname}
runner = uv-venv-lock-runner
dependency_groups =
    tox
no_default_groups = false
setenv =
    py310: PYRIGHT_PYTHON_VERSION = 3.10
    py311: PYRIGHT_PYTHON_VERSION = 3.11
    py312: PYRIGHT_PYTHON_VERSION = 3.12
    py313: PYRIGHT_PYTHON_VERSION = 3.13
    py314: PYRIGHT_PYTHON_VERSION = 3.14
commands =
    # Format validation with Ruff
    ruff format --check --quiet --diff --target-version py310 .
    # Linting with Ruff
    ruff check --target-version py310 .
    # Checking imports with isort
    isort -c --profile black --python-version auto .
    # Checking formatting with black
    black --check .
    # Analyzing the code with pylint
    pylint -j 4 src tests
    # Analyzing typing with pyright
    pyright --pythonversion {env:PYRIGHT_PYTHON_VERSION}
    # Run pytest
    pytest

# Quick check environment - runs checks only once on your current Python version
[testenv:check]
description = Run all checks once on current Python version
commands =
    ruff format --check --quiet --diff --target-version py310 .
    ruff check --target-version py310 .
    isort -c --profile black --python-version auto .
    black --check .
    pylint -j 4 src tests
    pyright
    pytest

# Fast test environment - only runs tests, no linting
[testenv:test]
description = Run only tests across all Python versions
envlist = py{310,311,312,313,314}
commands =
    pytest
