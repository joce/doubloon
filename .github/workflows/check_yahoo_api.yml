name: Check Yahoo! API availability

on:
  schedule:
    - cron: "7 0,12 * * *"
  workflow_dispatch:

jobs:
  check_yahoo_api:
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/master'
    steps:
      - name: Check out the repository
        uses: actions/checkout@v5

      - name: Install uv
        uses: astral-sh/setup-uv@v6
        with:
          version: "latest"
          python-version: "3.14"

      - name: Run pytest
        uses: pavelzw/pytest-action@v2
        with:
          verbose: true
          emoji: false
          job-summary: true
          custom-pytest: "uv run pytest tests/calahan/integration/test_yfinance_integration.py"
          click-to-expand: true
          report-title: "Yahoo! API availability test Report"
